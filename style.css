/* === 1. Box sizing global para layout más predecible === */
*,
*::before,
*::after {
  box-sizing: border-box;
}

/* === 2. Variables para colores y estilos globales === */
:root {
  --color-linea: #ba3b0a;
  --color-punto: #0066cc;
  --color-texto-sombra: rgba(0, 0, 0, 0.75);
  --color-background-panel-leaflet: #f0f0f0;
  --color-panel-hover: #e8e8e8;

  /* NEW: Variables para el slider y el span (simplificadas) */
  --slider-height: 8px; /* Altura de la pista del slider */
  --slider-thumb-size: 18px; /* Tamaño del "mango" del slider */
  --slider-track-bg: rgba(0, 0, 0, 0.15); /* Color de la pista */
  --slider-thumb-bg: var(--color-linea); /* Color del "mango" */
  --slider-border-radius: 4px; /* Radio de borde para elementos del slider */
  --slider-shadow-light: 0 1px 3px rgba(0,0,0,0.1); /* Sombra ligera */
  --slider-shadow-medium: 0 2px 5px rgba(0,0,0,0.2); /* Sombra media */

  --span-text-color: #333;
}

/* === 3. Estructura base === */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: Arial, sans-serif; /* Poner una fuente base aquí */
}

#map {
  width: 100%;
  height: 100vh;
}

/* === 4. Marca de agua (abajo a la izquierda) === */
#marca-agua {
  position: absolute;
  bottom: 30px;
  left: 5px;
  font-size: 12px;
  color: rgba(0, 0, 0, 0.7);
  background: rgba(255, 255, 255, 0.5);
  padding: 6px 8px;
  border-radius: 6px;
  /* font-family: Arial, sans-serif; - Ya definido en body */
  pointer-events: auto;
  max-width: 500px;
  min-width: 250px;
  width: auto;
  box-sizing: border-box;
  line-height: 1.3;
  user-select: none;
  cursor: pointer;
  z-index: 1000;
}

#marca-agua a,
#marca-agua a:visited {
  color: inherit;
  text-decoration: underline;
}

/* === 5. Título superior centrado === */
#titulo-ruta {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 18px;
  font-weight: 600;
  color: rgba(0, 0, 0, 0.7);
  background: rgba(255, 255, 255, 0.85);
  padding: 10px 20px;
  border-radius: 8px;
  /* font-family: Arial, sans-serif; - Ya definido en body */
  text-align: center;
  user-select: none;
  z-index: 1000;
  max-width: 90vw;
}

/* === 6. Etiqueta de puntos de interés === */
.titulo-punto span {
  font-weight: bold;
  font-size: 14px;
  color: white;
  text-shadow:
    -1px -1px 2px var(--color-texto-sombra),
    1px -1px 2px var(--color-texto-sombra),
    -1px 1px 2px var(--color-texto-sombra),
    1px 1px 2px var(--color-texto-sombra);
  pointer-events: none;
  white-space: nowrap;
}


/* === 7. Efecto hover popups === */
/* Miniaturas en los popups (galería GLightbox) */
.leaflet-popup-content .glightbox img {
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  border: 1px solid #ccc;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* Efecto al pasar el ratón */
.leaflet-popup-content .glightbox:hover img {
  transform: scale(1.05);
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  border-color: #888;
}

/* === CONTENEDOR GENERAL DEL PANEL EXPANDIDO === */
.leaflet-control-layers-expanded {
  padding: 10px;
  background-color: var(--color-background-panel-leaflet, #f9f9f9); /* Usa tu variable aquí */
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  border: 2px solid #aaa;
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  gap: 12px; /* espacio entre grupos */
}


/* === PANEL LATERAL DEL CONTROL JERÁRQUICO === */
.leaflet-control-layers-tree {
  /* font-family: Arial, sans-serif; - Ya definido en body */
  font-size: 14px;
  color: #333;
  background: transparent;
}

/* === TÍTULOS DE GRUPOS (ej. "Mapas base", "Capas superpuestas") === */
.leaflet-layerstree-header-pointer {
  font-weight: bold;
  font-size: 15px;
  color: #222;
}

/* === OCULTAR BOTONES DE EXPANSIÓN (+ y −) === */
.leaflet-layerstree-closed,
.leaflet-layerstree-opened {
  display: none !important;
}

/* === ÍTEMS INDIVIDUALES (checkbox/radio + texto) === */
.leaflet-control-layers-selector {
  margin-right: 20px;
}

.leaflet-control-layers-item label {
  display: flex;
  align-items: center;
  padding: 6px 8px;
  cursor: pointer;
  gap: 8px;
  transition: background-color 0.2s ease;
  font-weight: normal;
}

.leaflet-control-layers-item label:hover {
  background-color: #f0f0f0;
  border-radius: 4px;
}

/* === ICONOS PERSONALIZADOS DE LEYENDA === */
.legend-line {
  width: 20px;
  height: 3px;
  background-color: var(--color-linea, #1e6b8a);
  display: inline-block;
  margin-right: 6px;
  border-radius: 2px;
  vertical-align: middle;
}

.legend-point {
width: 24px; /* Ajusta este tamaño para que la imagen se vea bien en la leyenda */
height: 24px; /* Ajusta este tamaño */
display: inline-block;
margin-right: 6px;
background-image: url('assets/img/marcador-puntos.png'); /* Ruta a tu imagen */
background-size: contain; /* Ajusta la imagen dentro del contenedor */
background-repeat: no-repeat;
background-position: center center; /* Centra la imagen */
vertical-align: middle;
}

/*! === BOTONES "Ver tiempo actual" y "Pronóstico 5 días" === */
.btn-clima {
  font-family: "Helvetica Neue", Arial, Helvetica, sans-serif;
  font-size: 13px;
  font-weight: bold;
  color: #333;
  padding: 6px 10px;
  width: 100%;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  border: none; /* <--- CAMBIO AQUÍ: Elimina el borde */
  background-color: transparent; /* <--- CAMBIO OPCIONAL: Si quieres que el botón no tenga color de fondo por defecto */
  border-radius: 6px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); /* Sombra sutil */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}


.btn-clima:hover {
  background-color: var(--color-panel-hover, #e8e8e8);
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.12); /* Slightly more visible shadow on hover */
  transform: translateY(-1px);
}

.btn-clima:active {
  transform: translateY(0);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05); /* Even softer shadow when pressed */
}

/* --- Estilos para las secciones colapsables personalizadas (como Previsión meteorológica) --- */

.custom-collapsible-section {
    margin-top: 10px; /* Espacio superior para separarla */
    border-top: 1px solid #ddd; /* Línea divisoria */
    padding-top: 10px; /* Relleno superior */
}

.custom-collapsible-header {
  font-family: "Helvetica Neue", Arial, Helvetica, sans-serif; /* Asegúrate de usar la misma fuente */
  font-size: 13px; /* O el tamaño que te parezca más cercano al de las cabeceras de la librería, normalmente son similares a los labels */
  font-weight: bold; /* Esto es clave para las cabeceras */
  color: #333; /* Color de texto que usa Leaflet por defecto */
  padding: 6px 10px; /* Relleno similar al que usa la librería para los elementos de control */
  cursor: pointer;
  background-color: transparent;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-radius: 4px; /* Bordes ligeramente redondeados */
  box-shadow: none;
  border: none;
}

.custom-collapsible-header:hover {
  background-color: var(--color-panel-hover, #e8e8e8) /* Ligero cambio al pasar el ratón */
}

.custom-collapsible-header .header-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.custom-collapsible-header .toggle-icon {
    margin-left: 8px;
    font-size: 10px;
    transition: transform 0.2s ease; /* Animación de rotación */
}

/* Estilos para el contenido que se colapsa */
.custom-collapsible-content {
    background-color: transparent;
    border: none;
    border-top: none; /* Evitar doble borde */
    border-radius: 0 0 4px 4px;
    max-height: 0;
    opacity: 0;
    overflow: hidden; /* Muy importante para ocultar el contenido */
    transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
}

/* Estado expandido del contenido */
.custom-collapsible-content[style*="block"] { /* Esto se activa cuando display es 'block' */
    max-height: 500px; /* Un valor lo suficientemente grande para todo el contenido */
    opacity: 1;
}


/* === UTILIDADES === */
.hidden {
  display: none !important;
}

/* === MODAL DE PRONÓSTICO === */
.modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5); /* Fondo semitransparente */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.modal-content {
  background: #fff;
  border-radius: 12px;
  padding: 20px 24px;
  max-height: 90vh;
  overflow-y: auto;
  max-width: 400px;
  width: 90%;
  /* font-family: Arial, sans-serif; - Ya definido en body */
  position: relative;
}

/* Botón "X" de cerrar */
.cerrar-modal {
  position: absolute;
  top: 10px;
  right: 12px;
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  color: #555;
}

/* === CONTENEDOR DE PESTAÑAS POR DÍA === */
.tabs-pronostico {
  display: flex;
  justify-content: space-between;
  margin: 12px 0;
  gap: 4px;
}

/* Botones de pestañas (días) */
.tabs-pronostico button {
  flex: 1;
  padding: 6px;
  font-size: 13px;
  background: #eee;
  border: 1px solid #ccc;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s;
}

/* Botón de pestaña activa */
.tabs-pronostico button.active {
  background: #3b6b4c;
  color: white;
  font-weight: bold;
}

/* Contenedor principal del contenido del día seleccionado */
.contenido-dia {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* === BLOQUES DE PRONÓSTICO CADA 3 HORAS === */
.franja-pronostico {
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap; /* Permite ajuste en pantallas pequeñas */
  padding: 8px;
  background: #f9f9f9;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  font-size: 13px;
}

/* Elementos individuales dentro de cada franja horaria */
.franja-pronostico div {
  text-align: center;
  flex: 1 1 33%; /* Cada dato ocupa hasta un tercio del ancho */
  margin-bottom: 4px;
}

/* Iconos meteorológicos más pequeños y coherentes */
.franja-pronostico img {
  width: 42px;
  height: 42px;
  object-fit: contain;
  margin: 4px 0;
}

/* === Estilos para el Slider de la Ruta y su Indicador === */
/* Contenedor del slider y el span para agruparlos */
.slider-container {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%); /* Centrar horizontalmente */
    width: 60%; /* Ajusta el ancho según necesites */
    max-width: 600px; /* Límite máximo para que no sea demasiado largo */
    display: flex;
    align-items: center;
    gap: 12px; /* Espacio entre el slider y el span */
    z-index: 1000;
    padding: 10px 15px; /* Añadir padding para que no se pegue a los bordes */
    background-color: rgba(255, 255, 255, 0.9); /* Fondo ligeramente transparente */
    border-radius: 10px;
    box-shadow: var(--slider-shadow-medium); /* Sombra ligera */
}

#slider-ruta {
    flex-grow: 1; /* Para que el slider ocupe el espacio restante */
    -webkit-appearance: none; /* Eliminar estilos por defecto de Chrome/Safari */
    appearance: none;
    width: 100%;
    height: var(--slider-height);
    background: transparent; /* El fondo se define en la pista */
    outline: none;
    margin: 0;
    cursor: pointer;
}

/* Estilo de la PISTA del slider (la barra) */
#slider-ruta::-webkit-slider-runnable-track {
    width: 100%;
    height: var(--slider-height);
    background: var(--slider-track-bg);
    border-radius: var(--slider-border-radius);
    /* NEW: Relleno de color a la izquierda del pulgar (progreso) */
    background: linear-gradient(to right,
        var(--slider-thumb-bg) 0%,
        var(--slider-thumb-bg) var(--_slider-fill-percent, 0%),
        var(--slider-track-bg) var(--_slider-fill-percent, 0%),
        var(--slider-track-bg) 100%
    );
}

#slider-ruta::-moz-range-track {
    width: 100%;
    height: var(--slider-height);
    background: var(--slider-track-bg);
    border-radius: var(--slider-border-radius);
    /* NEW: Relleno para Firefox */
    background: linear-gradient(to right,
        var(--slider-thumb-bg) 0%,
        var(--slider-thumb-bg) var(--_slider-fill-percent, 0%),
        var(--slider-track-bg) var(--_slider-fill-percent, 0%),
        var(--slider-track-bg) 100%
    );
}

/* Estilo del MANGO del slider (el círculo/pulgar) */
#slider-ruta::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: var(--slider-thumb-size);
    height: var(--slider-thumb-size);
    border-radius: 50%; /* Redondo */
    background: var(--slider-thumb-bg);
    border: 2px solid white; /* Borde blanco para destacarse */
    box-shadow: var(--slider-shadow-light);
    margin-top: calc((var(--slider-height) - var(--slider-thumb-size)) / 2); /* Centrar verticalmente */
    transition: background 0.2s ease, box-shadow 0.2s ease, transform 0.1s ease;
}

#slider-ruta::-moz-range-thumb {
    width: var(--slider-thumb-size);
    height: var(--slider-thumb-size);
    border-radius: 50%;
    background: var(--slider-thumb-bg);
    border: 2px solid white;
    box-shadow: var(--slider-shadow-light);
    transition: background 0.2s ease, box-shadow 0.2s ease, transform 0.1s ease;
}

/* Efecto hover/active en el MANGO */
#slider-ruta::-webkit-slider-thumb:hover,
#slider-ruta::-moz-range-thumb:hover {
    background: #c74b1c; /* Un tono un poco más oscuro para el hover */
    box-shadow: var(--slider-shadow-medium);
}

#slider-ruta:active::-webkit-slider-thumb,
#slider-ruta:active::-moz-range-thumb {
    transform: scale(1.1); /* Ligeramente más grande al arrastrar */
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.4);
}

/* === Estilo del Span para mostrar el valor del Slider === */
#slider-value {
    font-size: 14px; /* Un poco más grande para ser legible */
    font-weight: bold;
    color: var(--span-text-color);
    padding: 4px 12px; /* Ajustado el padding */
    background-color: transparent; /* El contenedor se encarga del fondo */
    border-radius: 6px; /* Borde más suave */
    min-width: 90px; /* Asegurar un ancho mínimo para que el texto no salte */
    text-align: center;
    user-select: none;
    white-space: nowrap; /* Evita que el texto se rompa en varias líneas */
}



/* ICONO PUNTOS INTERÉS: Halo negro */
.leaflet-marker-icon-puntos {
  filter: drop-shadow(0px 0px 3px rgba(0,0,0,0.7)); /* Sombra negra suave */
}

/* ICONO RUTA : Halo verde */
.leaflet-marker-icon-ruta {
  filter: drop-shadow(0px 0px 8px rgba(0,128,0,1)); /* Sombra verde */
}
